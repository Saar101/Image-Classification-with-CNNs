# Rockâ€“Paperâ€“Scissors Image Classification with CNNs

A comprehensive TensorFlow/Keras-based image classification project implementing a **Convolutional Neural Network (CNN)** for classifying hand gesture images into rock, paper, and scissors categories.

![TensorFlow](https://img.shields.io/badge/TensorFlow-2.20+-orange)
![Python](https://img.shields.io/badge/Python-3.10+-blue)
![License](https://img.shields.io/badge/License-MIT-green)

---

## ğŸ“‹ Overview

This project demonstrates end-to-end deep learning workflow:
- **Data Pipeline**: Automated Kaggle API-based dataset acquisition and preprocessing
- **Model Architecture**: Multi-layer CNN with batch normalization and regularization
- **Training**: Adam optimizer with early stopping and model checkpointing
- **Evaluation**: Comprehensive accuracy metrics and misclassification analysis
- **Deployment Ready**: Both Jupyter Notebook and standalone Python script

---

## ğŸ¯ Features

âœ… **Automated Dataset Download** â€“ Kaggle API integration for seamless data acquisition  
âœ… **TF.Data Pipeline** â€“ Efficient input pipeline with prefetching and batching  
âœ… **CNN Architecture** â€“ 3-layer convolutional network with max-pooling and dropout  
âœ… **Model Checkpointing** â€“ Saves best model based on validation loss  
âœ… **Early Stopping** â€“ Prevents overfitting with configurable patience  
âœ… **Error Analysis** â€“ Visualizes misclassified examples for debugging  
âœ… **Dual Format** â€“ Jupyter Notebook (`main.ipynb`) and Python script (`main.pyt`)  

---

## ğŸ“ Project Structure

```
Image-Classification-with-CNNs/
â”œâ”€â”€ main.ipynb                 # Interactive Jupyter Notebook
â”œâ”€â”€ main.pyt                   # Standalone Python script
â”œâ”€â”€ requirements.txt           # Python dependencies
â”œâ”€â”€ README.md                  # This file
â””â”€â”€ data/
    â”œâ”€â”€ archive.zip           # Dataset (auto-downloaded)
    â””â”€â”€ rps_data/             # Extracted dataset
        â”œâ”€â”€ rock/
        â”œâ”€â”€ paper/
        â””â”€â”€ scissors/
```

---

## ğŸ”§ Requirements

- **Python**: 3.10 or higher
- **Key Packages**:
  - TensorFlow 2.20+
  - NumPy
  - Matplotlib
  - Kaggle API
  - Pillow

Install all dependencies:
```bash
pip install -r requirements.txt
```

---

## ğŸš€ Quick Start

### Option 1: Jupyter Notebook
```bash
jupyter notebook main.ipynb
```
Run cells sequentially to download data, train, and evaluate the model.

### Option 2: Python Script
```bash
python main.pyt
```
Executes the complete pipeline from data download to evaluation.

---

## ğŸ§  Model Architecture

| Layer | Configuration | Parameters |
|-------|----------------|-----------|
| **Input** | 150Ã—150 RGB images | â€“ |
| **Rescaling** | Normalize to [0, 1] | â€“ |
| **Conv2D #1** | 32 filters, 3Ã—3 kernel, ReLU | 896 |
| **MaxPool #1** | 2Ã—2 pool | â€“ |
| **Conv2D #2** | 64 filters, 3Ã—3 kernel, ReLU | 18,496 |
| **MaxPool #2** | 2Ã—2 pool | â€“ |
| **Conv2D #3** | 128 filters, 3Ã—3 kernel, ReLU | 73,856 |
| **MaxPool #3** | 2Ã—2 pool | â€“ |
| **Flatten** | â€“ | â€“ |
| **Dense #1** | 128 units, ReLU | 131,200 |
| **Dropout** | 50% | â€“ |
| **Output** | 4 classes, Softmax | 516 |
| **Total Parameters** | â€“ | ~225K |

---

## ğŸ“Š Training Configuration

```python
RUN_FULL_TRAIN = True              # Train for full NUM_EPOCHS
EARLY_STOPPING_PATIENCE = 5         # Stop if no improvement for 5 epochs
NUM_EPOCHS = 30                     # Maximum training epochs
BATCH_SIZE = 32                     # Samples per batch
IMAGE_SIZE = (150, 150)             # Input image resolution
VALIDATION_SPLIT = 0.2              # 80% train, 20% validation
```

**Optimizer**: Adam (learning rate: 0.001)  
**Loss Function**: Sparse Categorical Crossentropy  
**Metrics**: Accuracy

---

## ğŸ“¦ Dataset

The project automatically downloads the **Rock-Paper-Scissors** dataset from Kaggle:
- **Source**: [drgfreeman/rockpaperscissors](https://www.kaggle.com/datasets/drgfreeman/rockpaperscissors)
- **Total Samples**: ~2,500 images
- **Classes**: 4 (rock, paper, scissors, + background)
- **Format**: PNG images (500Ã—500 px, auto-resized to 150Ã—150)

**Setup**: Place `kaggle.json` in `~/.kaggle/` for API authentication.

---

## ğŸ“ˆ Results & Evaluation

The model generates:
- **Training curves** (loss & accuracy per epoch)
- **Validation accuracy** on holdout set
- **Misclassified examples** visualization (up to 6 samples)
- **Saved Models**:
  - `best_rps_model.keras` (best checkpoint)
  - `rps_cnn_final.keras` (final model)

---

## ğŸ” Key Code Sections

### Data Loading
```python
importer = DataImporter()
data_dir = importer.import_data()  # Auto-downloads & extracts
```

### Model Definition
```python
model = tf.keras.Sequential([
    tf.keras.layers.Rescaling(1./255, input_shape=(150,150,3)),
    tf.keras.layers.Conv2D(32, (3,3), activation='relu'),
    tf.keras.layers.MaxPooling2D((2,2)),
    # ... 2 more Conv+Pool blocks ...
    tf.keras.layers.Dense(num_classes, activation='softmax')
])
```

### Training
```python
history = model.fit(
    train_ds, 
    validation_data=val_ds, 
    epochs=NUM_EPOCHS, 
    callbacks=callbacks
)
```

---

## ğŸ› ï¸ Customization

**To adjust training:**
- Edit `NUM_EPOCHS`, `BATCH_SIZE`, `IMAGE_SIZE` in cell/script
- Modify model layers (add Conv2D, Dense, or Dropout)
- Change `EARLY_STOPPING_PATIENCE` for different early stopping behavior

**To improve performance:**
- Use data augmentation (rotation, flip, zoom)
- Increase image resolution (200Ã—200, 224Ã—224)
- Apply transfer learning (ResNet, MobileNet pretrained weights)
- Implement class weighting for imbalanced data

---

## ğŸ“š Dependencies

See `requirements.txt` for complete list. Key versions:
```
tensorflow==2.20.0
numpy>=1.24.0
matplotlib>=3.6.0
kaggle>=1.5.12
Pillow>=9.0.0
```

---

## ğŸ“ Usage Examples

### Train the model
```bash
python main.pyt
```
Trains for 30 epochs and saves the best model.

### Run in Jupyter
```bash
jupyter notebook main.ipynb
```
Execute cells in order for interactive training.

### Load and predict with saved model
```python
import tensorflow as tf
model = tf.keras.models.load_model('rps_cnn_final.keras')
predictions = model.predict(new_images)
```

---

## ğŸš§ Future Enhancements

- [ ] Data augmentation pipeline (rotation, brightness, zoom)
- [ ] Transfer learning with pre-trained backbones (ResNet50, MobileNetV2)
- [ ] TensorBoard integration for real-time monitoring
- [ ] Confusion matrix and classification report
- [ ] Flask/FastAPI web service for inference
- [ ] Model quantization for mobile deployment
- [ ] Automated hyperparameter tuning (Keras Tuner)

---


## ğŸ‘¤ Author

Developed as an educational deep learning exercise.

---

## ğŸ”— References

- [TensorFlow Documentation](https://www.tensorflow.org)
- [Keras Sequential API](https://keras.io/api/models/sequential/)
- [Kaggle Datasets](https://www.kaggle.com/datasets)

---

**Last Updated**: December 2025

